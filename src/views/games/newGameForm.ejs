<!DOCTYPE html>
<html lang="en">
  <%- include('../partials/head') %>
  <body>
    <%- include('../partials/nav') %>
    
    <form action="/games/new" method="POST">
      <p>New game:</p>

      <%- include('../partials/showError') %>

      <p>
        <label for="title">Title:</label>
        <input type="text" id="title" name="title" value="<%= typeof title !== 'undefined' ? title : '' %>" required />
      </p>

      <p>
        <label for="released">Released:</label>
        <input type="number" id="released" name="released" value="<%= typeof released !== 'undefined' ? released : '' %>" required />
      </p>

      <p>
        <label for="genre">Genre:</label>
        <select name="genre" id="genre">
          <option value="" disabled <%= typeof genre === 'undefined' || !genre ? 'selected' : '' %>>Select genre</option>
          <% genres.forEach(genreItem => { %>
          <option value="<%= genreItem.genre_id %>" <%= typeof genre !== 'undefined' && genre == genreItem.genre_id ? 'selected' : '' %>><%= genreItem.name %></option>
          <% }); %>
        </select>
      </p>

      <fieldset>
        <legend>Platform:</legend>
        <% platforms.forEach(platform => { %>
        <input
          type="checkbox"
          name="platforms"
          value="<%= platform.platform_id %>"
          id="platform-<%= platform.platform_id %>"
          <%= typeof selectedPlatforms !== 'undefined' && (Array.isArray(selectedPlatforms) ? selectedPlatforms.includes(platform.platform_id.toString()) : selectedPlatforms == platform.platform_id) ? 'checked' : '' %>
        />
        <label for="platform-<%= platform.platform_id %>">
          <%= platform.name %>
        </label>
        <% }); %>
      </fieldset>

      <button type="submit">Add</button>
    </form>
    <br />
    <%- include('../partials/goBack') %>

    <%- include('../partials/footer') %>
  </body>
</html>
